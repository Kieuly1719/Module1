<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ch·ªânh S·ª≠a Th√¥ng Tin Nh√¢n Vi√™n</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <h1>‚úèÔ∏è Ch·ªânh S·ª≠a Th√¥ng Tin & L∆∞∆°ng Nh√¢n Vi√™n</h1>
    <nav>
        <a href="index.html">‚Üê Quay l·∫°i Dashboard</a>
    </nav>
</header>

<main>
    <form id="edit_employee_form">
        <h2>ID Nh√¢n vi√™n: <span id="employee_id_display"></span></h2>
        <input type="hidden" id="emp_id">

        <h3>Th√¥ng tin C√° nh√¢n</h3>

        <label for="emp_name">H·ªç v√† T√™n:</label>
        <input type="text" id="emp_name" required>

        <label for="emp_position">Ch·ª©c v·ª•:</label>
        <input type="text" id="emp_position" required>

        <label for="emp_address">ƒê·ªãa ch·ªâ:</label>
        <input type="text" id="emp_address">

        <label for="emp_phone">S·ªë ƒëi·ªán tho·∫°i:</label>
        <input type="tel" id="emp_phone">

        <label for="emp_email">Email:</label>
        <input type="email" id="emp_email">

        <h3>Qu·∫£n l√Ω L∆∞∆°ng</h3>
        <label for="emp_salary">L∆∞∆°ng c∆° b·∫£n (VNƒê):</label>
        <input type="number" id="emp_salary" required min="0">

        <button type="submit" class="submit-btn">üíæ L∆∞u Thay ƒê·ªïi</button>
    </form>
</main>

<script src="qlnv.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // 1. L·∫•y ID t·ª´ URL
        const urlParams = new URLSearchParams(window.location.search);
        const employeeId = parseInt(urlParams.get('id'));

        // 2. T√¨m ki·∫øm nh√¢n vi√™n b·∫±ng ID
        const danhSach = taiDanhSachNV();
        const employee = danhSach.find(emp => emp.id === employeeId);

        if (!employee) {
            alert("Kh√¥ng t√¨m th·∫•y nh√¢n vi√™n n√†y!");
            window.location.href = "index.html";
            return;
        }

        document.getElementById('employee_id_display').textContent = employee.id;
        document.getElementById('emp_id').value = employee.id;
        document.getElementById('emp_name').value = employee.name;
        document.getElementById('emp_position').value = employee.position;
        document.getElementById('emp_address').value = employee.address;
        document.getElementById('emp_phone').value = employee.phone;
        document.getElementById('emp_email').value = employee.email;
        document.getElementById('emp_salary').value = employee.baseSalary;

        // 4. X·ª≠ l√Ω s·ª± ki·ªán Submit Form
        document.getElementById('edit_employee_form').addEventListener('submit', function(e) {
            e.preventDefault();

            // L·∫•y d·ªØ li·ªáu ƒë√£ ch·ªânh s·ª≠a
            const updatedData = {
                id: employeeId, // Gi·ªØ nguy√™n ID
                name: document.getElementById('emp_name').value,
                phone: document.getElementById('emp_phone').value,
                address: document.getElementById('emp_address').value,
                email: document.getElementById('emp_email').value,
                position: document.getElementById('emp_position').value,
                baseSalary: parseInt(document.getElementById('emp_salary').value)
            };

            // G·ªçi h√†m c·∫≠p nh·∫≠t (ch√∫ng ta s·∫Ω th√™m h√†m n√†y v√†o script.js)
            capNhatNhanVien(updatedData);

            // Chuy·ªÉn h∆∞·ªõng v·ªÅ trang ch√≠nh
            window.location.href = "index.html";
        });
    });
</script>
</body>
</html>